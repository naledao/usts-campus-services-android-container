import{_ as I,l as r,r as p,o as S,c as h,a as _,d as l,w as i,Z as A,b as y,Y as F,e as U,B as N}from"./index-f76ea637.js";import{s as o,U as b,F as T,C as q}from"./index-d1477609.js";import{F as z}from"./index-a88b428d.js";const D={class:"login-page"},E={style:{margin:"16px"}},G={__name:"App",setup(M){const t=r(""),d=r(""),n=r(!1),s=r(!1),u=r(60);let m=null;const w=[{required:!0,message:"请填写邮箱"},{validator:e=>/.+@.+\..+/.test(e),message:"邮箱格式不正确"}];function x(e=60){u.value=e,s.value=!0,clearInterval(m),m=setInterval(()=>{u.value<=1?(clearInterval(m),s.value=!1,u.value=60):u.value-=1},1e3)}async function C(){if(!/.+@.+\..+/.test(t.value)){o("请先填写有效邮箱");return}if(!(s.value||n.value))try{n.value=!0;const e=await b.sendLoginCode(t.value);console.log(e),o("验证码已发送"),x(60)}catch(e){o((e==null?void 0:e.message)||"发送失败，请稍后重试")}finally{n.value=!1}}async function V(){if(!/.+@.+\..+/.test(t.value)){o("请填写有效邮箱");return}if(!d.value){o("请填写验证码");return}try{const a=(await b.login(t.value,d.value)).token;localStorage.setItem("token",a),window.location.href="/index.html"}catch(e){o((e==null?void 0:e.message)||"登录失败，请检查验证码")}}return(e,a)=>{const f=p("van-field"),g=p("van-button"),k=p("van-cell-group"),B=p("van-form");return S(),h("main",D,[a[3]||(a[3]=_("h1",{class:"title"},"邮箱验证码登录",-1)),l(B,{onSubmit:V},{default:i(()=>[l(k,{inset:""},{default:i(()=>[l(f,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=v=>t.value=v),name:"email",label:"邮箱",type:"text",placeholder:"请输入邮箱",clearable:"",rules:w},null,8,["modelValue"]),l(f,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=v=>d.value=v),name:"code",label:"验证码",type:"number",maxlength:"6",placeholder:"请输入收到的验证码",clearable:""},{button:i(()=>[l(g,{size:"small",type:"primary",loading:n.value,disabled:s.value||n.value,onClick:A(C,["prevent"])},{default:i(()=>[y(F(s.value?`${u.value}s`:"发送验证码"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])]),_:1}),_("div",E,[l(g,{round:"",block:"",type:"primary","native-type":"submit"},{default:i(()=>[...a[2]||(a[2]=[y("登录",-1)])]),_:1})])]),_:1}),a[4]||(a[4]=_("p",{class:"tips"}," 登录即表示同意并遵守相关条款。 ",-1))])}}},L=I(G,[["__scopeId","data-v-885a362c"]]),c=U(L);c.use(z);c.use(T);c.use(q);c.use(N);c.mount("#app");
