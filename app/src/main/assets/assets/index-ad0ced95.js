import{q as N,A as ge,l as I,n as Z,t as K,C as V,D as _,m as p,f as E,g as w,E as ce,F as be,G as se,d as h,H as re,I as U,s as A,J as F,K as xe,L as Te,M as ke,u as J,N as Oe,x as ee,v as ye,y as Q,O as te,P as Ce,z as ue,Q as we,R as Ee,S as Se}from"./index-04865497.js";import{a as Pe,u as de}from"./index-b27b16a4.js";import{u as Ie}from"./index-16586b91.js";const[Be,y,ne]=N("picker"),fe=e=>e.find(l=>!l.disabled)||e[0];function De(e,l){const t=e[0];if(t){if(Array.isArray(t))return"multiple";if(l.children in t)return"cascade"}return"default"}function L(e,l){l=Z(l,0,e.length);for(let t=l;t<e.length;t++)if(!e[t].disabled)return t;for(let t=l-1;t>=0;t--)if(!e[t].disabled)return t;return 0}const le=(e,l,t)=>l!==void 0&&e.some(r=>r[t.value]===l);function X(e,l,t){const r=e.findIndex(c=>c[t.value]===l),o=L(e,r);return e[o]}function $e(e,l,t){const r=[];let o={[l.children]:e},c=0;for(;o&&o[l.children];){const d=o[l.children],b=t.value[c];if(o=ge(b)?X(d,b,l):void 0,!o&&d.length){const v=fe(d)[l.value];o=X(d,v,l)}c++,r.push(d)}return r}function Ne(e){const{transform:l}=window.getComputedStyle(e),t=l.slice(7,l.length-1).split(", ")[5];return Number(t)}function Re(e){return I({text:"text",value:"value",children:"children"},e)}const ae=200,oe=300,He=15,[me,W]=N("picker-column"),ve=Symbol(me);var Me=K({name:me,props:{value:V,fields:_(Object),options:p(),readonly:Boolean,allowHtml:Boolean,optionHeight:_(Number),swipeDuration:_(V),visibleOptionNum:_(V)},emits:["change","clickOption","scrollInto"],setup(e,{emit:l,slots:t}){let r,o,c,d,b;const v=E(),m=E(),s=E(0),g=E(0),T=Pe(),C=()=>e.options.length,S=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,k=i=>{let f=L(e.options,i);const n=-f*e.optionHeight,a=()=>{f>C()-1&&(f=L(e.options,i));const u=e.options[f][e.fields.value];u!==e.value&&l("change",u)};r&&n!==s.value?b=a:a(),s.value=n},x=()=>e.readonly||!e.options.length,z=i=>{r||x()||(b=null,g.value=ae,k(i),l("clickOption",e.options[i]))},P=i=>Z(Math.round(-i/e.optionHeight),0,C()-1),R=w(()=>P(s.value)),j=(i,f)=>{const n=Math.abs(i/f);i=s.value+n/.003*(i<0?-1:1);const a=P(i);g.value=+e.swipeDuration,k(a)},B=()=>{r=!1,g.value=0,b&&(b(),b=null)},q=i=>{if(!x()){if(T.start(i),r){const f=Ne(m.value);s.value=Math.min(0,f-S())}g.value=0,o=s.value,c=Date.now(),d=o,b=null}},G=i=>{if(x())return;T.move(i),T.isVertical()&&(r=!0,re(i,!0));const f=Z(o+T.deltaY.value,-(C()*e.optionHeight),e.optionHeight),n=P(f);n!==R.value&&l("scrollInto",e.options[n]),s.value=f;const a=Date.now();a-c>oe&&(c=a,d=f)},D=()=>{if(x())return;const i=s.value-d,f=Date.now()-c;if(f<oe&&Math.abs(i)>He){j(i,f);return}const a=P(s.value);g.value=ae,k(a),setTimeout(()=>{r=!1},0)},H=()=>{const i={height:`${e.optionHeight}px`};return e.options.map((f,n)=>{const a=f[e.fields.text],{disabled:u}=f,M=f[e.fields.value],$={role:"button",style:i,tabindex:u?-1:0,class:[W("item",{disabled:u,selected:M===e.value}),f.className],onClick:()=>z(n)},he={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:a};return h("li",$,[t.option?t.option(f,n):h("div",he,null)])})};return ce(ve),de({stopMomentum:B}),be(()=>{const i=r?Math.floor(-s.value/e.optionHeight):e.options.findIndex(a=>a[e.fields.value]===e.value),f=L(e.options,i),n=-f*e.optionHeight;r&&f<i&&B(),s.value=n}),se("touchmove",G,{target:v}),()=>h("div",{ref:v,class:W(),onTouchstartPassive:q,onTouchend:D,onTouchcancel:D},[h("ul",{ref:m,style:{transform:`translate3d(0, ${s.value+S()}px, 0)`,transitionDuration:`${g.value}ms`,transitionProperty:g.value?"all":"none"},class:W("wrapper"),onTransitionend:B},[H()])])}});const[_e]=N("picker-toolbar"),Y={title:String,cancelButtonText:String,confirmButtonText:String},Ve=["cancel","confirm","title","toolbar"],Ae=Object.keys(Y);var Le=K({name:_e,props:Y,emits:["confirm","cancel"],setup(e,{emit:l,slots:t}){const r=()=>{if(t.title)return t.title();if(e.title)return h("div",{class:[y("title"),"van-ellipsis"]},[e.title])},o=()=>l("cancel"),c=()=>l("confirm"),d=()=>{var v;const m=(v=e.cancelButtonText)!=null?v:ne("cancel");if(!(!t.cancel&&!m))return h("button",{type:"button",class:[y("cancel"),U],onClick:o},[t.cancel?t.cancel():m])},b=()=>{var v;const m=(v=e.confirmButtonText)!=null?v:ne("confirm");if(!(!t.confirm&&!m))return h("button",{type:"button",class:[y("confirm"),U],onClick:c},[t.confirm?t.confirm():m])};return()=>h("div",{class:y("toolbar")},[t.toolbar?t.toolbar():[d(),r(),b()]])}});const[pe,Xe]=N("picker-group"),Ue=Symbol(pe);I({tabs:p(),activeTab:A(0),nextStepText:String,showToolbar:F},Y);const Fe=I({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:A(44),showToolbar:F,swipeDuration:A(1e3),visibleOptionNum:A(6)},Y),Ke=I({},Fe,{columns:p(),modelValue:p(),toolbarPosition:xe("top"),columnsFieldNames:Object});var Ye=K({name:Be,props:Ke,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:l,slots:t}){const r=E(),o=E(e.modelValue.slice(0)),{parent:c}=ce(Ue),{children:d,linkChildren:b}=Te(ve);b();const v=w(()=>Re(e.columnsFieldNames)),m=w(()=>ke(e.optionHeight)),s=w(()=>De(e.columns,v.value)),g=w(()=>{const{columns:n}=e;switch(s.value){case"multiple":return n;case"cascade":return $e(n,v.value,o);default:return[n]}}),T=w(()=>g.value.some(n=>n.length)),C=w(()=>g.value.map((n,a)=>X(n,o.value[a],v.value))),S=w(()=>g.value.map((n,a)=>n.findIndex(u=>u[v.value.value]===o.value[a]))),k=(n,a)=>{if(o.value[n]!==a){const u=o.value.slice(0);u[n]=a,o.value=u}},x=()=>({selectedValues:o.value.slice(0),selectedOptions:C.value,selectedIndexes:S.value}),z=(n,a)=>{k(a,n),s.value==="cascade"&&o.value.forEach((u,M)=>{const $=g.value[M];le($,u,v.value)||k(M,$.length?$[0][v.value.value]:void 0)}),te(()=>{l("change",I({columnIndex:a},x()))})},P=(n,a)=>{const u={columnIndex:a,currentOption:n};l("clickOption",I(x(),u)),l("scrollInto",u)},R=()=>{d.forEach(a=>a.stopMomentum());const n=x();return te(()=>{const a=x();l("confirm",a)}),n},j=()=>l("cancel",x()),B=()=>g.value.map((n,a)=>h(Me,{value:o.value[a],fields:v.value,options:n,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:m.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:u=>z(u,a),onClickOption:u=>P(u,a),onScrollInto:u=>{l("scrollInto",{currentOption:u,columnIndex:a})}},{option:t.option})),q=n=>{if(T.value){const a={height:`${m.value}px`},u={backgroundSize:`100% ${(n-m.value)/2}px`};return[h("div",{class:y("mask"),style:u},null),h("div",{class:[Ce,y("frame")],style:a},null)]}},G=()=>{const n=m.value*+e.visibleOptionNum,a={height:`${n}px`};return!e.loading&&!T.value&&t.empty?t.empty():h("div",{ref:r,class:y("columns"),style:a},[B(),q(n)])},D=()=>{if(e.showToolbar&&!c)return h(Le,ye(ee(e,Ae),{onConfirm:R,onCancel:j}),ee(t,Ve))},H=n=>{n.forEach((a,u)=>{a.length&&!le(a,o.value[u],v.value)&&k(u,fe(a)[v.value.value])})};J(g,n=>H(n),{immediate:!0});let i;return J(()=>e.modelValue,n=>{!Q(n,o.value)&&!Q(n,i)&&(o.value=n.slice(0),i=n.slice(0)),e.modelValue.length===0&&H(g.value)},{deep:!0}),J(o,n=>{Q(n,e.modelValue)||(i=n.slice(0),l("update:modelValue",i))},{immediate:!0}),se("touchmove",re,{target:r}),de({confirm:R,getSelectedOptions:()=>C.value}),()=>{var n,a;return h("div",{class:y()},[e.toolbarPosition==="top"?D():null,e.loading?h(Oe,{class:y("loading")},null):null,(n=t["columns-top"])==null?void 0:n.call(t),G(),(a=t["columns-bottom"])==null?void 0:a.call(t),e.toolbarPosition==="bottom"?D():null])}}});const et=ue(Ye),[ze,O]=N("nav-bar"),je={title:String,fixed:Boolean,zIndex:V,border:F,leftText:String,rightText:String,leftDisabled:Boolean,rightDisabled:Boolean,leftArrow:Boolean,placeholder:Boolean,safeAreaInsetTop:Boolean,clickable:F};var qe=K({name:ze,props:je,emits:["clickLeft","clickRight"],setup(e,{emit:l,slots:t}){const r=E(),o=Ie(r,O),c=s=>{e.leftDisabled||l("clickLeft",s)},d=s=>{e.rightDisabled||l("clickRight",s)},b=()=>t.left?t.left():[e.leftArrow&&h(Ee,{class:O("arrow"),name:"arrow-left"},null),e.leftText&&h("span",{class:O("text")},[e.leftText])],v=()=>t.right?t.right():h("span",{class:O("text")},[e.rightText]),m=()=>{const{title:s,fixed:g,border:T,zIndex:C}=e,S=Se(C),k=e.leftArrow||e.leftText||t.left,x=e.rightText||t.right;return h("div",{ref:r,style:S,class:[O({fixed:g}),{[we]:T,"van-safe-area-top":e.safeAreaInsetTop}]},[h("div",{class:O("content")},[k&&h("div",{class:[O("left",{disabled:e.leftDisabled}),e.clickable&&!e.leftDisabled?U:""],onClick:c},[b()]),h("div",{class:[O("title"),"van-ellipsis"]},[t.title?t.title():s]),x&&h("div",{class:[O("right",{disabled:e.rightDisabled}),e.clickable&&!e.rightDisabled?U:""],onClick:d},[v()])])])};return()=>e.fixed&&e.placeholder?o(m):m()}});const tt=ue(qe),Ge="modulepreload",Je=function(e,l){return new URL(e,l).href},ie={},nt=function(l,t,r){if(!t||t.length===0)return l();const o=document.getElementsByTagName("link");return Promise.all(t.map(c=>{if(c=Je(c,r),c in ie)return;ie[c]=!0;const d=c.endsWith(".css"),b=d?'[rel="stylesheet"]':"";if(!!r)for(let s=o.length-1;s>=0;s--){const g=o[s];if(g.href===c&&(!d||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${b}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":Ge,d||(m.as="script",m.crossOrigin=""),m.href=c,document.head.appendChild(m),d)return new Promise((s,g)=>{m.addEventListener("load",s),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})})).then(()=>l()).catch(c=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c})};export{tt as N,et as P,nt as _,Fe as p};
